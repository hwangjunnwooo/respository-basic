## P3.12 A system is described by its transfer function

$$\frac{Y(s)}{R(s)}=T(s)=\frac{8(s+5)}{s^3+12s^2+44s+48}$$

(a) Determine a state varible model  

$$\frac{Y(s)}{R(s)}=T(s)=\frac{8(s+5)\cdot Z(s)}{(s^3+12s^2+44s+48)\cdot Z(s)}$$

$$Y(s) = [8s + 40]\cdot Z(s)$$

$$R(s) = [s^3+12s^2+44s+48]\cdot Z(s)$$

$$y(t) = 8z'(t) + 40z(t)$$

$$r(t) = z'''(t) + 12z''(t) + 44z'(t)+48z(t)$$

상태 변수를 다음과 같이 선언한다. 

$$
x(t) = 
\begin{bmatrix}
z(t) \\
z'(t) \\
z''(t)
\end{bmatrix}
$$

$$z'''(t) = - 12z''(t) - 44z'(t) - 48z(t) + r(t)$$

$$
x'(t) =
\begin{bmatrix}
0 & 1 & 0 \\  
0 & 0 & 1 \\  
-48 & -44 & -12 \\  
\end{bmatrix}
x(t) +
\begin{bmatrix}
0 \\  
0 \\  
1 \\  
\end{bmatrix} 
r(t)
$$  

$$
y(t) =
\begin{bmatrix}
40 & 8 & 0 
\end{bmatrix}
x(t)
$$

(b) Determine the stte transition matrix, $\Phi (t)$

$$
sX(s)=AX(s)+BR(s)
$$

$$
[sI-A]X(s)=BR(s)
$$

$$
X(s)=[sI-A]^{-1}BR(s)
$$

$$
\Phi (s)=[sI-A]^{-1}
$$

$$
A = \begin{bmatrix}
0 & 1 & 0 \\  
0 & 0 & 1 \\  
-48 & -44 & -12 \\  
\end{bmatrix}
$$

직접 구하기에는 복잡하므로 매트랩을 이용한다.  

$$
\Phi (s)=[sI-A]^{-1}
$$

다음은 매트랩 코드이다. 
```
syms s
A = [0 1 0;
    0 0 1;
    -48 -44 -12]

Phi = inv(s*eye(3)-A)
```

결과를 확인하면 다음과 같다. 

$$
\Phi (s)=[sI-A]^{-1} = \frac{1}{s^3+12s^2+44s+48} 
\begin{pmatrix}
s^2+12s+44 & s + 12 & 1 \\
-48 & s^2+12s & s \\
-48s & -44s-48 & s^2 
\end{pmatrix}
$$

라플라스 역변환도 매트랩을 통해 실행한다. 코드는 다음과 같다.  
```
Phi_t = ilaplace(Phi)
```

결과는 다음과 같다.  

$$
\Phi (t) =
\begin{bmatrix}
3e^{-2t} -3e^{-4t} +e^{-6t} & \frac{5e^{-2t} }{4}-2e^{-4t} +\frac{3e^{-6t}}{4}  & \frac{e^{-2t}}{8}-\frac{e^{-4t} }{4}+\frac{e^{-6t} }{8}  \\
12e^{-4t} -6e^{-2t} -6e^{-6t} & 8e^{-4t} -\frac{   5e^{-2t} }{2}-\frac{9e^{-6t}}{2} & e^{-4t} -\frac{e^{-2t} }{4}-\frac{3e^{-6t}}{4} \\
12e^{-2t} -48e^{-4t} +36e^{-6t} & 5e^{-2t} -32e^{-4t} +27e^{-6t} & \frac{e^{-2t} }{2}-4 e^{-4t} +\frac{9e^{-6t}}{2} 
\end{bmatrix}
$$
